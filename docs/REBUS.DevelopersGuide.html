<html>
<style>
td {padding-top:12pt;font-family:times;font-size:12pt;text-align:justify;}
pre {font-size:10pt;}
.section {font-size:16pt;font-weight:bold;font-family:arial;}
.subsection {font-size:12pt;font-weight:bold;font-family:arial;}
</style>
<body>

<table width=95%>
<tr><td style="padding-top:0pt;">
<table width=100% cellpadding=0 cellspacing=0>
<tr>
<td class=subsection style="padding-top:0pt;">
REBUS Developer's Guide
</td>
<td width=100 style="padding-top:0pt;text-align:right">
v2.2
</td>
</tr>
</table>
<hr>
</td></tr>
<tr><td style="padding-top:0pt;">
This document is intended for developers of REBUS plug-ins. It describes the physical REBUS architecture and provides exhaustive information on how to program REBUS plug-ins.
</td></tr>
<tr><td style="padding-top:10pt;">
<table cellpadding=4>
<tr><td style="padding-top:0pt;"><a href="#1">Architecture</a></td></tr>
<tr><td style="padding-top:0pt;"><a href="#2">Core</a></td></tr>
<tr><td style="padding-top:0pt;"><a href="#3">Plug-ins</a></td></tr>
<tr><td style="padding-top:0pt;"><a href="#4">File system structure</a></td></tr>
<tr><td style="padding-top:0pt;"><a href="#5">Plug-ins programming</a></td></tr>
<tr><td style="padding-top:0pt;"><a href="#6">Project templates</a></td></tr>
</table>
</td></tr>
<tr><td class=section>
<a name="1">Architecture
</td></tr>
<tr><td>
REBUS Server was developed with modular architecture to be more flexible to customers needs. Architecturally server consists of core part and plug-ins part. The core part contains non-modifiable program components, which provides the basic functionality for compilation your project releases using client/server approach. The plug-ins part contains pluggable scripting modules that realizes details in the release compilation business-process of a particular developer, such as different kinds of libraries getting, libraries lay outing, version controlling, regeneration and linking modes and so on.
</td></tr>
<tr><td class=subsection>
<a name="2">Core
</td></tr>
<tr><td>
The Core components provide basic functionality of a release compilation in the client/server manner. This part of REBUS server includes simple web server, project configuration facility, remote release compilation facility and possibility of observation release compilation process output.
</td></tr>
<tr><td>
Usually, you don’t need to modify core scripting components. If you need additional core functionality you may propose your suggestion to us. We examine it with great pleasure.
</td></tr>
<tr><td class=subsection>
<a name="3">Plug-ins
</td></tr>
<tr><td>
Plug-in is a scripting module that automates a self-depending part of a release compilation process, for example, compiling or lay outing.</td></tr>
<tr><td>
</td></tr>
<tr><td>
We’ve develop some basic plug-ins already. They let you to organize the typical release compilation business-process for applications developed on PowerBuilder platform. Full description of this plug-ins you can find in the “REBUS.User’s Guide”.
</td></tr>
<tr><td>
You can develop your own plug-ins due to automate specific details of development business-process of your organization. See Plug-ins programming section for details.</td></tr>
<tr><td class=section>
<a name="4">File system structure
</td></tr>
<tr><td>
In this section the file system structure of REBUS Server is described. All paths are relative paths to the folder in which you installed the product.
</td></tr>
<tr><td>
	<table>
	<tr>
		<td width=120>/config </td>
		<td>the server configuration file is placed here. You can edit this file for your own needs manually.
		</td>
	</tr>
	<tr>
		<td>/core </td>
		<td>contains files that realizes the Core of REBUS Server. Please, do not edit this files, it may be dangerous for server stability.</td>	
	</tr>
	<tr>
		<td>/templates </td>
		<td>contains project templates. You can place here your own templates. Added templates will appear automatically on new project page.</td>	
	</tr>
	<tr>
		<td>/plugins </td>
		<td>contains plug-ins. After plug-in creation you must to place new plug-in into this folder.</td>	
	</tr>
	</table>
</td></tr>
<tr><td class=section>
<a name="5">Plug-ins programming
</td></tr>
<tr><td>
Plug-ins development as simple as you can imagine it. All you need to know is a JavaScript programming language and maybe some COM libraries, such as Microsoft Scripting library, it depends on your task.
</td></tr>
<tr><td>
The plug-in is a program component written according to the WSH (Windows Script Host) technology. In other words it is COM in special format, written in JavaScript programming language using any text editor.
</td></tr>
<tr><td>
Each plug-in must realize a simple program interface:
</td></tr>
<tr><td>
	<table>
	<tr><td width=20></td><td>
	<b>project</b> property. The Core assigns Project object to this property, so you receive access to the Logger object and receive access to other plug-ins of the project
	</td></tr>
	<tr><td></td><td>
		<table>	
		<tr><td width=30></td><td>
		The Project object defines following properties:
		</td>
		<tr><td></td><td>
<b>logger</b> – is a reference to the Logger object. You can use it to output information to the project log-file.
		</td>
		<tr><td></td><td>
<b>config</b> – is a reference to the IXMLDOMDocument object, which contains project configuration xml-file.
		</td>
		<tr><td></td><td>
<b>path</b> – is a string represented the path where files of the project are located.
		</td>
		<tr><td></td><td>
		The Project object defines following methods:
		</td>
		<tr><td></td><td>
<b>plugin(<plug-in classname>)</b> – returns the reference to the Plug-in object with the given class name. Using this method you can receive access to the properties of any plug-in executed before this one.
		</td>
		</table>
	</td></tr>
	<tr><td></td><td>
	<b>parms</b> property. The Core assigns plug-in parameters to this property, so you can define the behavior of your plug-in using parameters values given by user during project configuration. This property object has one method: get(<parameter name>), which returns the value of a parameter with given name.
	</td></tr>
	<tr><td></td><td>
	<b>run()</b> method. The Core executes plug-ins using the “run” method. This is the entry point of your plug-in logic.
	</td></tr>
	<tr><td></td><td>
	<b>getParmsDef()</b> method. The Core uses this method to obtain the definition of plug-in parameters. This method returns a string that contains XML-definition of plug-in parameters in the following format:
	</td></tr>
	<tr><td></td><td>
		<table>	
		<tr><td width=30></td><td>
		&lt;parms>&lt;ParamName>DefaulParamValue&lt;/ParamName>&lt;/parms>, where:
		</td>
		<tr><td></td><td>
ParamName is a parameter name, which the user will see in the configuration page.
		</td>
		<tr><td></td><td>
DefaultParamValue is a default parameter value. It can be an empty, a simple string, or a compound string to let the user selects from the list of predefined values, for example: 1:NoRegeneration;2:Regeneration;3:FullRebuild.
		</td>
		</table>
	</td></tr>
	</table>
</td></tr>
<tr><td>
Each plug-in can expose it’s own properties due to pass useful information to subsequent plug-ins. For example, REBUS.SCCGetFile plug-in needs to know the reference to the SCC object due to get files from source code storage, but the SCC object is constructed in the REBUS.SourceCodeControl plug-in. That is why REBUS.SourceCodeControl plug-in exposes “scc” property, connects to the SCC Vendor and assigns to “scc” property the reference to constructed SCC object.
</td></tr>
<tr><td>
Here is an example of a dummy plug-in. Please, note that classid field in the registration section must be UNIQUE for each your plug-in.
</td></tr>
<tr><td>
<pre>&lt;?XML version="1.0" encoding="utf-8"?>
&lt;component>
&lt;registration 
   description="Dummy"
   progid="Dummy"
   version="1"
   classid="{43C70DFD-D571-49dc-8853-D5653BF524E3}"
   remotable="true" />
&lt;public> 
   &lt;method name="getParmsDef" internalName="getParmsDef"/>
   &lt;property name="project"/>
   &lt;property name="parms"/>
   &lt;method name="run" internalName="run"/>
&lt;/public> 
&lt;script language="JScript">
	&lt;![CDATA[ 
		function getParmsDef()
		{
			return '&lt;parms>&lt;ExeName>&lt;/ExeName>'+
				'&lt;/parms>';
		}

		function run()
		{
			project.logger.write( "> dummy plugin: " +
				parms.get("ExeName") );
		}
	]]>
&lt;/script>
&lt;/component>
</pre>
</td></tr>
<tr><td>
Please note that getParmsDef method must be the first method in the plug-in's method list.
</td></tr>
<tr><td>
You need to place plug-in file in the “plugins” folder to let using it. After that it will appear in the plug-in list on the project configuration page.
</td></tr>
<tr><td class=section>
<a name="6">Project templates
</td></tr>
<tr><td>
Project template is a usual project configuration file you want to use as a template for new projects. Project template intends to reduce a time spending on project configuration. When you see that some project configuration is applicable to others project you need to define a template. You need to clean up some specific project settings in the project configuration file and to copy it into the templates folder. After that the new project template will appear on the new project page.
</td></tr>
<tr><td>
Any questions? E-mail us: <a href="mailto:support@pbdevex.com">support@pbdevex.com</a>
</td></tr>
<tr><td>
<hr>
Copyright (c) 2005, <a href="http://www.pbdevex.com">PBDevEx Software</a>
</td></tr>
</table>

</body>
</html>